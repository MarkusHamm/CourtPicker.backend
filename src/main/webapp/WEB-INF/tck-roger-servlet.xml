<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:mvc="http://www.springframework.org/schema/mvc" 
	xsi:schemaLocation="http://www.springframework.org/schema/beans
		http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">

<!--<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
	<property name="driverClassName" value="com.mysql.jdbc.Driver" />
	<property name="url" value="jdbc:mysql://localhost:3306/Roger" />
	<property name="username" value="root" />
	<property name="password" value="" />
	<property name="initialSize" value="5" />
	<property name="maxActive" value="10" />
</bean>-->

<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
	<property name="driverClassName" value="org.postgresql.Driver" />
	<property name="url" value="jdbc:postgresql://localhost:5432/roger" />
	<property name="username" value="roger" />
	<property name="password" value="avarel1" />
</bean>

<bean id="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate">
	<property name="dataSource" ref="dataSource" />
</bean>

<!--
<bean id="tilesConfigurer" class="org.springframework.web.servlet.view.tiles2.TilesConfigurer">
	<property name="definitions"> 
		<list>
			<value>/WEB-INF/tiles.xml</value>
		</list>
	</property>
	<property name="preparerFactoryClass">
        <value>org.springframework.web.servlet.view.tiles2.SpringBeanPreparerFactory</value>
    </property>
</bean>
-->
  
<!--
<bean id="tilesViewResolver" class="org.springframework.web.servlet.view.UrlBasedViewResolver" >
	<property name="viewClass" value="org.springframework.web.servlet.view.tiles2.TilesView" />
      <property name="order" value="1" />
</bean>
-->

<bean id="viewResolver" class="org.springframework.web.servlet.view.UrlBasedViewResolver">
  <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"/>
  <property name="prefix" value="/WEB-INF/views/"/>
  <property name="suffix" value=".jsp"/>
</bean>

<mvc:view-controller path="/index.htm" view-name="index"></mvc:view-controller>
<mvc:view-controller path="/benefits.htm" view-name="benefits"></mvc:view-controller>
<mvc:view-controller path="/features.htm" view-name="features"></mvc:view-controller>
<mvc:view-controller path="/pricelist.htm" view-name="pricelist"></mvc:view-controller>
<mvc:view-controller path="/courtsearch.htm" view-name="courtsearch"></mvc:view-controller>
<mvc:view-controller path="/references.htm" view-name="references"></mvc:view-controller>
<mvc:view-controller path="/whycourtpicker.htm" view-name="whycourtpicker"></mvc:view-controller>
<mvc:view-controller path="/ueberuns.htm" view-name="ueberuns"></mvc:view-controller>
<mvc:view-controller path="/contact.htm" view-name="contact"></mvc:view-controller>
<mvc:view-controller path="/agb.htm" view-name="agb"></mvc:view-controller>
<mvc:view-controller path="/datasecuritystatement.htm" view-name="datasecuritystatement"></mvc:view-controller>

<!--   <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver"> -->
<!--       <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"/> -->
<!--       <property name="prefix" value="/WEB-INF/views/"/> -->
<!--       <property name="suffix" value=".jsp"/> -->
<!--       <property name="order" value="1" /> -->
<!--   </bean> -->
  
<!-- allow annotation based configuration -->
<context:annotation-config/>
<context:component-scan base-package="com.courtpicker"/>

<!-- the following enables multi-language support -->
<mvc:interceptors>
    <bean class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor">
        <property name="paramName" value="lang" />
    </bean>
</mvc:interceptors>

<bean id="messageSource"
    class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
    <property name="basename" value="WEB-INF/classes/messages" />
</bean>
 
<bean id="localeChangeInterceptor"
    class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor">
    <property name="paramName" value="lang"></property>
</bean>
 
<bean id="localeResolver"
    class="org.springframework.web.servlet.i18n.CookieLocaleResolver">
    <property name="defaultLocale" value="de"/>
</bean>

<bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping">
</bean>
<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
    <property name = "messageConverters">
        <list>
        	<ref bean="stringHttpMessageConverter"/>
            <bean class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter">
                <property name="objectMapper" ref="jsonObjectMapper"/>
            </bean>
        </list>
    </property>
</bean>

<bean id="jsonObjectMapper" class="org.codehaus.jackson.map.ObjectMapper"/>

<bean class="org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter"/>
<bean id="stringHttpMessageConverter" 
       class="org.springframework.http.converter.StringHttpMessageConverter">
       <property name="supportedMediaTypes" value="text/plain;charset=UTF-8"/>
</bean>
	
<!-- spring multipart fileupload support -->
<bean id="multipartResolver"
	  class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
	  <property name="maxUploadSize" value="5000000"/>
</bean>

<bean id="mailSender" class="org.springframework.mail.javamail.JavaMailSenderImpl">
	<property name="host" value="mail.gmx.net"/>
	<!--<property name="host" value="localhost"/>-->
	<property name="username" value="matthiasheindl@gmx.at" />
	<property name="password" value="avarel123" />
	<property name="port" value="465" />
<!--	<property name="port" value="25" />-->
	<property name="protocol" value="smtps" />
<!--	<property name="protocol" value="smtp" /> -->
	<property name="javaMailProperties">
		<props> 
			<prop key="mail.smtp.starttls.enable">true</prop>
			<prop key ="mail.smtps.auth">true</prop>
<!--			<prop key="mail.smtp.starttls.enable">false</prop>-->
<!--			<prop key ="mail.smtps.auth">false</prop>-->
		</props>
	</property>
</bean>

<bean id="mailMessage" class="org.springframework.mail.SimpleMailMessage">
	<property name="from">
		<value><![CDATA[matthiasheindl@gmx.at]]></value>
	</property>
	<property name="subject" value="TCK Reservierungsbestätigung" />
	<property name="text">
		<value><![CDATA[
Hallo %USER%!
Das ist Ihre Reservierungsbestätigung!
Sie haben folgende Plätze reserviert:

Rechnungsnummer: %INVOICE%		
%RES%
		
Der Gesamtpreis beträgt %SUM% Euro. Bitte überweisen Sie die Gesamtsumme bis spätestens 48 Stunden nach dem Spieltermin an:
		
Tennisclub Kalksburg
Kontonummer: %KONTO%.
Bankleitzahl: %BANK%

Als Verwendungszweck geben Sie bitte die oben angeführte Rechnungsnummer an.
		
Mit sportlichen Grüßen
Tennisclub Kalksburg]]></value>
	</property>

</bean>

<bean id="mailCancellationMessage" class="org.springframework.mail.SimpleMailMessage">
	<property name="from">
		<value><![CDATA[matthiasheindl@gmx.at]]></value>
	</property>
	<property name="subject" value="TCK Stornierungsbestätigung" />
	<property name="text">
		<value><![CDATA[
Hallo %USER%!

%RES%
				
Mit sportlichen Grüßen
Tennisclub Kalksburg]]></value>
	</property>

</bean>

<bean id="registrationMailMessage" class="org.springframework.mail.SimpleMailMessage">
	<property name="from">
		<value><![CDATA[matthiasheindl@gmx.at]]></value>
	</property>
	<property name="subject" value="TCK: Bestätigen Sie Ihren Account" />
	<property name="text">
		<value><![CDATA[
Hallo %USER%!
Bitte klicken Sie auf den unten angegebenen Link, um Ihren Roger-Account zu bestätigen und freizuschalten.
Sobald Sie das erledigt haben können Sie sich auf Roger einloggen und die Funktionalitäten der Plattform nutzen. 

%URL%
		
Mit sportlichen Grüßen
Tennisclub Kalksburg]]></value>
	</property>

</bean>
<bean id="passwordMailMessage" class="org.springframework.mail.SimpleMailMessage">
	<property name="from">
		<value><![CDATA[matthiasheindl@gmx.at]]></value>
	</property>
	<property name="subject" value="TCK: Ihr Password" />
	<property name="text">
		<value><![CDATA[
Hallo %VORNAME%!
Ihr Benutzername lautet: %USER%
Damit Sie Ihren Account wieder benutzen können, müssen Sie Ihr Passwort ändern.
Klicken Sie dazu auf folgenden Link:

%URL%

Danach sollten Sie sich wieder ganz normal mit Benutzername und dem neuen Passwort anmelden können.
		
Mit sportlichen Grüßen
Tennisclub Kalksburg]]></value>
	</property>
</bean>
 
<bean id="mailInvitationMessage" class="org.springframework.mail.SimpleMailMessage">
	<property name="from">
		<value><![CDATA[tennis@tckalksburg.at]]></value>
	</property>
	<property name="subject" value="TCK Einladung zu einer Stunde" />
	<property name="text">
		<value><![CDATA[
Hallo %USER%!

%USER% hat Sie zu folgender Stunde eingeladen: %RES%
Klicken Sie dazu auf folgenden Link um die Einladung zu sehen und zu-oder abzusagen:

%RES% 
				
Mit sportlichen Grüßen
Tennisclub Kalksburg]]></value>
	</property>

</bean>

</beans>